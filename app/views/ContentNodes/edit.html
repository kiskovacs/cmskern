<!--suppress XmlUnboundNsPrefix -->
#{extends 'main.html' /}
#{set title: 'Edit ' + contentType.displayName /}

#{set 'moreStyles'}
    <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/ui-lightness/jquery-ui-1.8.18.custom.css'}">
#{/set}

#{set 'moreScripts'}
    <script type="text/javascript" src="@{'/public/javascripts/jquery/jquery-ui-1.8.18.custom.min.js'}"></script>

    <!-- Angular Core Library -->
    <script type="text/javascript" src="@{'/public/javascripts/angular/angular.js'}" ng:autobind></script>

    <!-- Angular Add-Ons -->
    <script type="text/javascript" src="@{'/public/javascripts/misc/date.format.js'}"></script>
    <script type="text/javascript" src="@{'/public/javascripts/misc/underscore-min.js'}"></script>
    <script type="text/javascript" src="@{'/public/javascripts/angular/addons/angular-widgets.js'}"></script>
    <script type="text/javascript" src="@{'/public/javascripts/angular/addons/angular-formatters.js'}"></script>

    <!-- Custom Angular Scripts for cmskern -->
    <script type="text/javascript" src="@{'/public/javascripts/controllers.js'}"></script>
    <script type="text/javascript" src="@{'/public/javascripts/filters.js'}"></script>
    <script type="text/javascript" src="@{'/public/javascripts/widgets.js'}"></script>

#{/set}

<script type="text/javascript">

    var globalContentType   = "${contentType.slug}";
    var globalContentSchema =  ${contentType.jsonForm.raw()};
    var globalSchemaRules   =  globalContentSchema.rules;

    // ~~ define data we are working with
    var globalContentNodeId = "${contentNode.id}";
    var globalContentNode   =  ${contentNode.jsonContent.raw()};

</script>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

<div class="metaInfo">
    Current Version: ${contentNode.version}, last edited on ${contentNode.modified.format('yyyy-MM-dd (HH:mm:ss)')}
</div>

<div ng:controller="EditContentNodeCtrl">

    <form class="form-horizontal" ng:submit="submit()">
        <my:form schema="contentSchema.fields" data="contentNode"></my:form>

        <div class="form-actions">
            <button class="btn btn-primary">Save</button>
            <button ng:click="reset()" class="btn">Cancel</button>
        </div>
    </form>

    <hr>
    <div id="model">
        contentNode = <pre>{{contentNode}}</pre>
    </div>

</div>