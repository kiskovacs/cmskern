<!-- Select one existing articles -->
<h3>Select Node</h3>

<ul>
#{list items: nodes, as:'node'}
    <li><a href="#"
           onclick="updateRef('${node._id}', '${node.data.title}')">${node.data.title}</a>
        (Path: ${node.data.path}, Parent: ${node.data.parent})
    </li>
#{/list}
</ul>


<fieldset>
    <label for="select_id">Node ID</label>
    <input type="text" id="select_id" name="value" value="${fields['id'].value}" readonly="readonly" />

    <label for="select_title">Title</label>
    <input type="text" id="select_title" name="title" value="${fields['title'].value}" />
</fieldset>


<script type="text/javascript">
    var selectedId    = -1;
    var selectedTitle = "";

    $(function() {
        selectedId = $('#select_id').val();
        selectedTitle = $('#select_title').val();
    });

    function updateRef(val, title) {
        selectedId = val;
        $("#select_id").val(val);
        selectedTitle = title;
        $("#select_title").val(title);
    }

    $("#select_title").on("change", function(event) {
        event.preventDefault();
        selectedTitle = $(this).val();
    });

    // contract: returns [ID, TITLE]
    function calloutGetSelectedValues() {
        return {
            '${fields['id'].targetFQName}': selectedId,
            '${fields['title'].targetFQName}': selectedTitle
        };
    }
</script>
