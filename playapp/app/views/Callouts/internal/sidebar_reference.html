*{
    Callout contract:
    possible srcPropnames: id
}*
#{set calloutfields = ['id', 'title'] /}

<h3>Select Sidebar</h3>

<ul>
#{list items: sidebars, as:'sidebar'}
    <li><a href="#" onclick="updateRef('${sidebar._id}', '${sidebar.data.title}')">${sidebar.data.title}</a></li>
#{/list}
</ul>


<fieldset>
    <label for="select_id">Sidebar ID</label>
    <input type="text" id="select_id" name="value" value="#{if fields.containsKey('id')}${fields['id'].value}#{/if}" readonly="readonly"/>
    <label for="select_title">Title</label>
    <input type="text" id="select_title" name="title"
           value="#{if fields.containsKey('title')}${fields['title'].value}#{/if}"/>
</fieldset>


<script type="text/javascript">

    // we need to hold the values in a separate variable, otherwise data is lost when the dialog is closed
    var selectedId = "";

    function updateRef(val, title) {
        selectedId = val;
        $("#select_id").val(val);

        selectedTitle = title;
        $("#select_title").val(title);

    }

    // contract: returns only the fields, which are in srcPropNames
    function calloutGetSelectedValues() {
        return {
          #{list items:calloutfields, as:'litem'}
            #{if fields[litem]}
            '${fields[litem].targetFQName}':selected${litem.capitalizeWords()},
            #{/if}
          #{/list}
        }
    }
</script>
